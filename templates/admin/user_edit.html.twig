{% extends "base.html.twig" %}

{% block title %}Éditer utilisateur
{% endblock %}

{% block body %}
	<div class="backoffice-container">
		<div class="page-header">
			<h1>Éditer l'utilisateur</h1>
			<p>Modifier les informations de
				{{ user.username }}</p>
		</div>

		<!-- Flash Messages -->
		{% for type, messages in app.flashes %}
			{% for message in messages %}
				<div class="alert alert-{{ type == 'error' ? 'danger' : type }} alert-dismissible fade show" role="alert">
					{{ message }}
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
			{% endfor %}
		{% endfor %}

		<div class="card">
			<div class="card-body">
				<form method="post" action="{{ path('app_user_edit', {id: user.id}) }}">
					<input type="hidden" name="_token" value="{{ csrf_token('edit-user-' ~ user.id) }}">

					<div class="mb-3">
						<label for="username" class="form-label">Nom d'utilisateur *</label>
						<input type="text" class="form-control" id="username" name="username" value="{{ user.username }}" required>
					</div>

					<div class="mb-3">
						<label for="password" class="form-label">Nouveau mot de passe</label>
						<input type="password" class="form-control" id="password" name="password" placeholder="Laisser vide pour ne pas modifier">
						<small class="form-text text-muted">Laissez vide si vous ne voulez pas changer le mot de passe</small>
					</div>

					<div class="mb-3">
						<label class="form-label">Rôles</label>
						<div class="form-check">
							<input class="form-check-input" type="checkbox" name="roles[]" value="ROLE_USER" id="roleUser" {{ 'ROLE_USER' in user.roles ? 'checked' : '' }}>
							<label class="form-check-label" for="roleUser">
								Utilisateur
							</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="checkbox" name="roles[]" value="ROLE_ADMIN" id="roleAdmin" {{ 'ROLE_ADMIN' in user.roles ? 'checked' : '' }}>
							<label class="form-check-label" for="roleAdmin">
								Administrateur
							</label>
						</div>
					</div>

					<div class="d-flex gap-2">
						<button type="submit" class="btn btn-primary">
							<i class="bi bi-save"></i>
							Enregistrer
						</button>
						<a href="{{ path('app_backoffice', {tab: 'users'}) }}" class="btn btn-secondary">
							<i class="bi bi-x"></i>
							Annuler
						</a>
					</div>
				</form>
			</div>
		</div>
	</div>
{% endblock %}
